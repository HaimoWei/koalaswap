server:
  port: ${SERVER_PORT:18080}

app:
  cors:
    allowed-origins: ${APP_CORS_ALLOWED_ORIGINS:http://localhost:5173,http://127.0.0.1:5173,http://localhost:5177,http://127.0.0.1:5177,http://localhost:4200,http://127.0.0.1:4200}

spring:
  main:
    web-application-type: reactive
  cloud:
    gateway:
      default-filters:
        - DedupeResponseHeader=Access-Control-Allow-Credentials Access-Control-Allow-Origin
      globalcors:
        add-to-simple-url-handler-mapping: true
        corsConfigurations:
          "[/**]":
            allowedOrigins: "${app.cors.allowed-origins}"
            allowedMethods: "*"
            allowedHeaders: "*"
            allowCredentials: true
      routes:
        - id: users-and-auth
          uri: ${USER_SERVICE_URL:http://localhost:12649}
          predicates:
            - Path=/api/users/**, /api/auth/**

        - id: products
          uri: ${PRODUCT_SERVICE_URL:http://localhost:12648}
          predicates:
            - Path=/api/products/**

        - id: images
          uri: ${PRODUCT_SERVICE_URL:http://localhost:12648}
          predicates:
            - Path=/api/images/**

        - id: categories
          uri: ${PRODUCT_SERVICE_URL:http://localhost:12648}
          predicates:
            - Path=/api/categories/**

        - id: favorites
          uri: ${PRODUCT_SERVICE_URL:http://localhost:12648}
          predicates:
            - Path=/api/favorites/**

        - id: orders
          uri: ${ORDER_SERVICE_URL:http://localhost:12650}
          predicates:
            - Path=/api/orders/**

        - id: reviews
          uri: ${REVIEW_SERVICE_URL:http://localhost:12651}
          predicates:
            - Path=/api/reviews/**

        - id: chat-http
          uri: ${CHAT_SERVICE_URL:http://localhost:12652}
          predicates:
            - Path=/api/chat/**

        - id: files
          uri: ${FILE_SERVICE_URL:http://localhost:12647}
          predicates:
            - Path=/api/files/**

        - id: chat-ws
          uri: ${CHAT_WS_URL:http://localhost:12652}
          predicates:
            - Path=/ws/chat/**

management:
  endpoints:
    web:
      exposure:
        include: health,info
